/* 
 * Nav Fractal CSS - Warm Gold/Copper Inlay Navigation
 * Replaces rounded/pill design with precision fractal inlay curves
 * Scoped to navigation only - does not affect global tokens
 */

/* ============================================
   1. WARM PALETTE OVERRIDES (NAV-SCOPED)
   ============================================ */
:root {
    /* Warm gold/copper palette - eliminates green/teal in nav */
    --menu-accent: var(--nft-title-color, #E5B457); /* Primary warm gold */
    --menu-accent-warm: #D48A45; /* Warm copper */
    --menu-accent-deep: #A4552B; /* Deep copper */
    
    /* Override nav-specific tokens to use warm tones */
    --menu-accent-rim: color-mix(in oklab, var(--menu-accent) 25%, transparent);
    --menu-bg-fractal: linear-gradient(180deg, 
        color-mix(in oklab, var(--glass-bg) 85%, var(--menu-accent-warm) 15%), 
        var(--glass-bg)
    );
}

/* ============================================
   2. FRACTAL MASK APPLICATION
   ============================================ */

/* Apply fractal inlay mask to all nav links EXCEPT placeholder */
.nav-link:not(.nav-placeholder) {
    /* Override previous mask with fractal SVG mask */
    -webkit-mask-image: url('../svg/nav-button-mask-fractal.svg');
    -webkit-mask-size: 220px 52px;
    -webkit-mask-repeat: no-repeat;
    -webkit-mask-position: center;
    
    mask-image: url('../svg/nav-button-mask-fractal.svg');
    mask-size: 220px 52px;
    mask-repeat: no-repeat;
    mask-position: center;
    
    /* Update background with warm gradient */
    background: var(--menu-bg-fractal);
    
    /* Ensure exact sizing to match mask - prevents layout shift */
    min-width: 220px;
    max-width: 220px;
    min-height: 52px;
    max-height: 52px;
}

/* ============================================
   3. FALLBACK FOR MASK-LESS BROWSERS
   ============================================ */

/* Fallback: Pill shape with notch hints using pseudo-elements */
@supports not (mask-image: url('../svg/nav-button-mask-fractal.svg')) {
    .nav-link:not(.nav-placeholder) {
        /* Graceful fallback to pill shape */
        border-radius: calc(var(--menu-radius) * 2);
        -webkit-mask-image: none;
        mask-image: none;
        
        /* Preserve sizing */
        min-width: 220px;
        max-width: 220px;
        min-height: 52px;
        max-height: 52px;
    }
    
    /* Add subtle notch hints with pseudo-elements */
    .nav-link:not(.nav-placeholder)::before {
        content: '';
        position: absolute;
        left: 60px;
        top: 50%;
        transform: translateY(-50%);
        width: 8px;
        height: 12px;
        border-radius: 50%;
        background: rgba(0, 0, 0, 0.15);
        pointer-events: none;
    }
    
    .nav-link:not(.nav-placeholder)::after {
        content: '';
        position: absolute;
        right: 60px;
        top: 50%;
        transform: translateY(-50%);
        width: 10px;
        height: 14px;
        border-radius: 50%;
        background: rgba(0, 0, 0, 0.15);
        pointer-events: none;
    }
}

/* ============================================
   4. HOVER & FOCUS STATES (WARM GRADIENTS)
   ============================================ */

/* Warm gradient hover - transform/opacity only for performance */
.nav-link:not(.nav-placeholder):hover {
    /* Warm gold to copper gradient on hover */
    background: linear-gradient(135deg, 
        var(--menu-accent) 0%, 
        var(--menu-accent-warm) 50%, 
        var(--menu-accent-deep) 100%
    );
    
    /* Performance: Only animate transform and opacity */
    transform: translateY(-1px) scale(1.02);
    opacity: 1;
}

/* Active state - slight scale down */
.nav-link:not(.nav-placeholder):active {
    background: linear-gradient(135deg, 
        var(--menu-accent-warm) 0%, 
        var(--menu-accent-deep) 100%
    );
    transform: translateY(0) scale(0.99);
}

/* Focus state - visible focus ring with accessible contrast */
.nav-link:not(.nav-placeholder):focus,
.nav-link:not(.nav-placeholder):focus-visible {
    /* Warm gold focus ring - ≥3:1 contrast with background */
    outline: 2px solid var(--menu-accent);
    outline-offset: -2px;
    
    /* Subtle warm gradient on focus */
    background: linear-gradient(135deg, 
        color-mix(in oklab, var(--menu-accent) 30%, var(--glass-bg) 70%),
        var(--glass-bg)
    );
}

/* ============================================
   5. NAV ORNAMENTS (LEFT/RIGHT FLOWING CURVES)
   ============================================ */

/* Left ornament container */
.nav-ornament--left {
    position: absolute;
    left: -170px; /* Position outside left edge of nav */
    top: 50%;
    transform: translateY(-50%);
    width: 160px;
    height: 48px;
    background-image: url('../svg/nav-left-fractal.svg');
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    pointer-events: none;
    opacity: 0.8;
    transition: opacity 0.3s ease;
}

/* Right ornament container */
.nav-ornament--right {
    position: absolute;
    right: -170px; /* Position outside right edge of nav */
    top: 50%;
    transform: translateY(-50%);
    width: 160px;
    height: 48px;
    background-image: url('../svg/nav-right-fractal.svg');
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    pointer-events: none;
    opacity: 0.8;
    transition: opacity 0.3s ease;
}

/* Fade in ornaments on nav hover */
.nav-menu:hover .nav-ornament--left,
.nav-menu:hover .nav-ornament--right {
    opacity: 1;
}

/* ============================================
   6. ACCESSIBILITY & PERFORMANCE
   ============================================ */

/* Ensure keyboard focus order unchanged */
.nav-link:not(.nav-placeholder) {
    /* Maintain existing focus order */
    position: relative;
    z-index: auto;
}

/* Ensure hitbox remains ≥40×40px (already guaranteed by min-height: 52px) */

/* Respect prefers-reduced-motion */
@media (prefers-reduced-motion: reduce) {
    .nav-link:not(.nav-placeholder),
    .nav-ornament--left,
    .nav-ornament--right {
        transition: none;
    }
    
    .nav-link:not(.nav-placeholder):hover {
        transform: none;
        /* Use filter instead for reduced motion */
        filter: brightness(1.15);
    }
    
    .nav-link:not(.nav-placeholder):active {
        transform: none;
        filter: brightness(1.05);
    }
}

/* ============================================
   7. MOBILE RESPONSIVE ADJUSTMENTS
   ============================================ */

@media (max-width: 768px) {
    /* Hide ornaments on mobile to reduce clutter */
    .nav-ornament--left,
    .nav-ornament--right {
        display: none;
    }
    
    /* Slightly reduce button size on mobile if needed */
    .nav-link:not(.nav-placeholder) {
        min-width: 180px;
        max-width: 180px;
        -webkit-mask-size: 180px 52px;
        mask-size: 180px 52px;
    }
}
